# Week2

작업자: 승규 한
상태: 진행 중
요약: Week1
마감일: 2024년 3월 31일

# Practice-oop-banking

## 구조

흐름

RunBanking → Person → BankingKiosk → BankServiceMediator → Clerk(CreateAccountClerk, DepositClerk, WithdrawClerk, RemittanceClerk, ChangeStatusClerk, GetAccountInfoClerk) → BankSystem ↔BankStorage

Test

패키지
Account(계좌관련), Bank(은행관련), exception(예외), interest(이자관련), person(사람), validate(공통 검증)

- RunBanking
    
    프로그램 실행 클래스
    
- Person
    
    뱅킹 서비스 이용자로 은행 업무를 볼지 안 볼지 의사결정을 한다.
    
- BankingKiosk
    
    은행서비스 중 어떤 서비스를 이용할지 결정한다.
    
- BankServiceMediator
    
    선택한 은행 서비스에 따라 적절한 은행원을 매칭 시켜준다
    
- Clerk(CreateAccountClerk, DepositClerk, WithdrawClerk, RemittanceClerk, ChangeStatusClerk, GetAccountInfoClerk)
    
    은행원 클래스로 각각의 은행원 역할에 따라 서로 다른 입력을 받고 수행하며 수행 결과를 알려준다.
    

- BankSystem
    
    은행 시스템으로 계좌번호 랜덤 생성,  BankStorage에서 계좌 정보들을 가져오고 그에 따른 역할을 수행 등 여러 기능을 하는 은행 시스템이다.
    

- BankStorage
    
    은행의 계좌 저장소로 등록된 모든 계좌들을 가지고 있는 저장소다.
    
- Account(DepositAccount, SavingAccount)
    
    계좌 도메인으로 입금, 출금, 송금, 상태 변경 계좌 정보 확인 로직이 있으며 계좌별 이자 정책을 가져 입금 시 이자를 계산해 준다. 
    

---

## 과제 요구사항 변경점

1. 계좌 클래스의 속성 계좌 종류를 “N”, ” S”대신 “예금 계좌”, “적금 계좌로” 저장하였다 
2. 적금계좌를 예금 계좌에서 상속 받지않고 예금계좌, 적금계좌 모두 Account Interface를 상속받게 하였다.
3. 계좌 클래스에 상태 변경 메서드 추가
4. 각 계좌 클래스마다 이자율을 알고 있다.
5. 중앙은행 클래스에서 다른 기능을 구현하지는 않았고 ArrayList가 아닌 Map으로 BankStorage에 모든 계좌가 저장될 때마다 중앙은행에도 같이 저장시켰다. (Test 클래스의  showCentralBankAccountList()메서드에서 확인)

---

## 구현 기능

Person이 은행 업무를 처리할지 결정 후

- 계좌 생성
- 입금
- 출금
- 송금
- 계좌 상태 변경
- 계좌 정보 조회

---

## 예외 처리

person의 행동 범위 내의 숫자 제외 예외

kiosk 값 입력 범위 내의 숫자 제외 예외

계좌 생성 : CreateAccountClerk에서 계좌 유형 입력 예외 처리

입금 : DepositClerk에서 계좌번호 형식, 금액 입력 형식 예외 처리

     BankSystem에서 계좌 못 찾은 경우, 비활성화 계좌인 경우

출금 : WithdrawClerk에서 계좌번호 형식, 금액 입력 형식 예외 처리

          BankSystem에서 계좌 못 찾은 경우, 비활성화 계좌인 경우

    Account 클래스에서 예금의 경우 잔고 없으면 출금 불가 적금의 경우 잔고, 목표금액 부족하면 출금 불가

송금 : RemittanceClerk에서 계좌번호 형식, 금액 입력 형식  예외 처리

          BankSystem에서 계좌 못 찾은 경우, 비활성화 계좌인 경우 

    Account 클래스에서 출금 계좌 잔고 또는 목표금액 부족 시 출금 불가 

계좌상태 변경 : ChangeStatusClerk에서 계좌번호 형식 예외 처리

                    BankSystem에서 계좌 못 찾은 경우

계좌 정보 확인 : GetAccountInfoClerk에서 계좌번호 형식 

                          BankSystem에서 계좌 못 찾은 경우

---

과제 작성 중 고민 내용

객체지향 코드를 작성하며 고민한 점들을 작성한다.

1. 구조
    
    객체지향 Banking 코드를 작성하면서 처음부터 끝까지 구조를 많이 변경했다. 처음 설계 과정에서는 과제 요구사항에 나와있는 Class를 기반으로 MVC 구조를 통해 작성하면 될것 같다고 생각했다. 하지만 막상 내가 설계한 대로 MVC 구조를 작성하면서 내 방식의 설계가 과제의 요구사항과는 맞지 않는 것 같다는 생각이 들었다. (지금 드는 생각은 설계가 미흡했던 것 같다.)
    
    그 이유는 서비스 클래스에서 담당하는 역할이 너무 많다고 느꼈고 은행, 계좌, 이자 간의 관계가 처음에 설계한 대로 짜이지 않고 의존관계가 엉켰기 때문이다. 이때 너무 MVC 구조에 얽매이지 말라는 조언을 듣고 익숙하지 않더라도 각각의 도메인을 세분화시켜 MVC 구조에 국한되지 않으며 도메인 중심 설계를 해봐야겠다는 생각이 들었다.  
    
    코드를 작성하는게 오랜만이기도 하고 설계 단계에서 각 도메인의 책임을 어떻게 분리할지 고민하는 데에 시간을 많이 쓰면서 이 기능은 어느 도메인에 포함되는게 적절할까? 같은 고민을 많이 했던 것 같다.  ex) 처음에는 계좌번호를 한글로 작성하면 은행 시스템에서 예외를 처리하게 했는데 생각해 보니 은행 시스템보다는 은행원 차원에서 예외 메시지를 작성해 줘야 하는 게 적절하겠다는 생각을 함
    
    결과적으로 사람, 은행(키오스크, 은행원, 은행 저장소), 계좌, 이자 도메인을 중심으로 코드를 작성하게 되었다. 
    
2. 예외처리
    
    계좌에서 예외를 던지면 은행원(clerk) 차원에서 에러 메시지를 보여주게 작성하였다.
    
    예외 처리를 하면서 고민이 있었는데 그냥 모두 하나의 예외로 처리할지 각각의 예외 상황마다 다른 예외로 처리할지 고민했다. 이 부분에 대한 결론은 exception 패키지에 각각의 예외 상황마다 클래스를 따로 만들어 주어 처리했다. 이 방법이 맞는 건지는 잘 모르겠다.
    
3. 계좌의 출금가능여부 검증로직
    
    출금 가능 여부 검증 로직을 계좌 클래스에 둘 것인가 검증 클래스에 둘 것인가 고민을 했다. 계좌 클래스에 두면 계좌상태에 대한 책임이 객체 안에서 캡슐화되어 srp가 지켜진다 생각했고 접근성이 좋다는 장점이 있지만 재사용성이 떨어진다 생각했다.
    
    검증 클래스에 두면 재사용성이 증가하고 검증을 계좌가 담당하지 않으니 이 또한 srp가 증가하는게  아닌가? 라는 생각을 했다 하지만 한편으론 검증 클래스에 의존성이 생기니까 안 좋은 방법인 것 같다는 생각도 했다. 
    
    결론적으로 나는 내가 설계한 계좌 도메인은 계좌에 관련된 기본적인 행위?를 제어하는게 주요 책임으로 생각했기 때문에 계좌에 검증 로직을 넣는게 맞다고 생각해 넣었다.
    
4. 계좌의 메서드 리턴 값
    
    계좌 클래스의 메서드들을 boolean 으로하고 시스템에서 메시지를 은행원에게 넘겨주는게 String을 반환하는 것보다 좋지 않을까 생각했는데 3항연산자를 사용할 경우는 예외를 던지지도 못하고 그러므로 시스템 클래스에 if else 문이 많아져 가독성이 떨어질 것 같아 String을 반환하는게 낫겠다고 생각했다(.(이런 경우에는 어떤 것에 더 중점을 두어 구현해야 하는건지 잘 모르겠다.)
    

1. 코드 작성
    
    코드를 작성하면서 내가 적절한 상황에 적절한 것을 작성하고 있는 건지 의문이 들었다. 이러한 의문은 주로 if나 switch, Map을 사용하면서 들었던 것 같다. 최대한 코드를 간결하고 명확하게 작성하고 싶었고 그런 방향으로 작성하려고 노력했지만 분명 그렇지 않은 부분이 존재할 것이라고 생각한다. 
    
    의존관계나 각각의 클래스가 단일 책임 원칙을 잘 준수하고 있는가에 대한 의문도 존재했다.
    
    ---
    
    ## 느낀 점
    
    구조를 엎고 설계하는 과정이 반복되면서 시간적 여유는 점점 줄어들었다.
    
    이번 과제를 통해 오랜만에 코드를 직접 작성하는 시간을 가졌는데 이 코드를 작성하면서 내가 몰랐거나 까먹었던 것을 찾아보고 공부하면서 알게 되었던 것이 많아서 좋았다.